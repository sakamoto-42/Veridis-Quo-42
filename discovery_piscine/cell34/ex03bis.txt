// IMPORTANT : SOUS WINDOWS, UTILISER UN SERVEUR LOCAL COMME XAMPP (PAR EXEMPLE) POUR QUE LA SAUVEGARDE ET LE CHARGEMENT DU COOKIE FONCTIONNE !
// SOUS UBUNTU : PAS BESOIN D'UTILISER UN SERVEUR LOCAL, MAIS LE COOKIE SERA STOCKE EN SESSION (IL SERA EFFACE SI LE NAVIGATEUR EST FERME), NE FONCTIONNE DONC QUE SI LA PAGE 
// EST RECHARGEE

cd /home/event/discovery_piscine
cd cell34
cd ex04
mkdir ex03bis
cd ex03bis

Aller sur https://jquery.com/download/ et faire un clic droit sur "Download the uncompressed, development jQuery 3.7.1" puis enregistrer la cible du lien sous...
Sélectionner le dossier /home/event/discovery_piscine/cell34/ex04/ex00bis

cp /home/event/discovery_piscine/cell33/ex03/index.html index.html

cp /home/event/discovery_piscine/cell33/ex03/todo.js todo.js

vim index.html
i

<!DOCTYPE html>
<html lang="en">		
	<head>
		<title>TO DO</title>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<style>
			html, body, .container {
				height: 100%;
			}

			body {
				margin: 0;
			}

			.container {
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
			}

			#ft_list {	
				margin: 20px;
				background-color: pink;
				border: 1px dashed black;
			}

			.todo_div {
				height: 20px;
				width: 100px;
				margin: 10px;
				border: 1px solid grey;
				background-color: skyblue;
				text-align: center;
			}

			button:hover {
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div id="ft_list"></div>
			<button id="new_btn">New</button>
		</div>
		<script src="jquery-3.7.1.js"></script>
		<script src="todo.js"></script>
	</body>
</html>


vim todo.js
i

const newBtn = $("#new_btn");						// JQUERY
const ftList = $("#ft_list");						// JQUERY
let todoList = [];

newBtn.on("click", function() {						// JQUERY
	let todoText = prompt("Fill a new TO DO");

	if (todoText !== null && todoText.trim().length > 0) {
		let newContent = todoText.trim();

		addTodo(newContent);
	}
});

function addTodo(content) {
	let todoDiv = $("<div>", {					// JQUERY : création de la div
		"class": "todo_div",					// JQUERY : ajout de la classe "todo_div"
		"text": content						// JQUERY : ajout du contenu texte
	});
	ftList.prepend(todoDiv);					// JQUERY : on insère la div todoDiv ainsi créée dans ftList, au début (en "préfixe") des autres
										// éléments qu'il contient

	todoDiv.on("click", function() {				// JQUERY
		if (window.confirm("Do you want to remove that TO DO ?")) {
			todoDiv.remove();
		}
	});
}

$(window).on("beforeunload", function() {				// JQUERY
	let todoDivs = $(".todo_div");					// JQUERY
	let JSONString;
	let encodedTodoList;

	todoDivs.each(function() {					// JQUERY
		todoList.unshift($(this).text());			// JQUERY
	});

	JSONString = JSON.stringify(todoList);
	encodedTodoList = encodeURIComponent(JSONString);

	setCookie("TODO", encodedTodoList, 7);
});

function setCookie(name, value, days) {
	let expires = "";

	if (days) {
		let date = new Date();
		date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
		expires = "; expires=" + date.toUTCString();
	}
	document.cookie = name + "=" + (value || "") + expires + "; path=/" + "; SameSite=Strict";
}


$(window).on("load", function() {					// JQUERY
	let todoCookie = getCookie("TODO");

	if (todoCookie) {
		let decodedTodoList = decodeURIComponent(todoCookie);
		let JSONTodoList;
		
		try {
			JSONTodoList = JSON.parse(decodedTodoList);
			JSONTodoList.forEach(addTodo);
		}
		catch(e) {
			console.error("Cookie decode error", e);
		}
	}
});

function getCookie(name) {
	let cookies = document.cookie.split(";");

	for (let i = 0 ; i < cookies.length ; i++) {
		let cookie = cookies[i].trim();
		
		if (cookie.startsWith(name + '='))
			return cookie.substring(name.length + 1);
	}
	return null;
}

echap
:wq
enter

firefox index.html